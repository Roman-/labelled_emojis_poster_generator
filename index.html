<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Canvas Emoji-Word Matrix</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
 body{font-family:system-ui,sans-serif;margin:1.2rem;max-width:1100px}
 label{display:block;margin:.4rem 0}
 input[type=number]{width:4rem}
 canvas{border:1px solid #ddd;margin-top:1rem;max-width:100%;height:auto}
</style>
<!-- Google-fonts preconnect -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
</head>
<body>
<h1>Emoji-Word Matrix (Canvas)</h1>

<section id="controls">
  <label>Columns  <input id="cols" type="number" min="1" max="20" value="6"></label>
  <label>Rows     <input id="rows" type="number" min="1" max="20" value="6"></label>
  <label>Max letters (0 = any) <input id="maxLen" type="number" min="0" max="10" value="0"></label>

  <label>Emoji size (px) 
    <input id="emojiSize" type="range" min="40" max="180" value="120">
    <span id="emojiVal">120</span>
  </label>

  <label>Label size (px) 
    <input id="labelSize" type="range" min="10" max="60" value="26">
    <span id="labelVal">26</span>
  </label>

  <label>Label font 
    <select id="fontSel">
      <option>Roboto</option>
      <option>Fredoka</option>
      <option>Comic Neue</option>
      <option>Baloo 2</option>
      <option>Gloria Hallelujah</option>
    </select>
  </label>

  <label>Padding (px) 
    <input id="padding" type="range" min="4" max="60" value="20">
    <span id="padVal">20</span>
  </label>

  <label>Grid stroke-width (px) 
    <input id="strokeW" type="range" min="0" max="10" value="2">
    <span id="strokeVal">2</span>
  </label>

  <label>Grid colour <input id="strokeCol" type="color" value="#cccccc"></label>

  <button id="generate">Generate</button>
  <button id="download">Download PNG</button>
</section>

<canvas id="matrix"></canvas>

<script type="module">
/* -----------------------------------------------------------
   1.  Fixed word-emoji dictionary
----------------------------------------------------------------*/
const wordMap = {
  ant:["🐜"],  ape:["🐒"], art:["🎨"], axe:["🪓"],
  bag:["👜","🛍️"], bat:["🦇"], bed:["🛌"], bee:["🐝"],
  bug:["🐛"], bus:["🚍"], cap:["🧢"], car:["🚗"],
  cat:["🐈"], cow:["🐄"], dog:["🐕"], egg:["🥚"],
  fan:["🪭"], fly:["🪰"], fog:["🌁"], fox:["🦊"],
  gem:["💎"], hat:["👒"], ice:["🧊"], jar:["🫙"],
  key:["🔑"], log:["🪵"], map:["🗺"], owl:["🦉"],
  pen:["🖊","✒️"], pie:["🥧"], pig:["🐖"], pin:["📍"],
  ram:["🐏"], rat:["🐀"], row:["🚣"], saw:["🪚"],
  sun:["☀️"], ski:["🎿"], tag:["🏷"], tea:["🍵"],
  van:["🚐"], web:["🕸"], yam:["🍠"], bank:["🏦"],
  bath:["🛀"], bear:["🐻"], bell:["🛎"], bird:["🐦"],
  bolt:["🔩"], bone:["🦴"], book:["📕"], boot:["🥾"],
  bowl:["🥣"], bulb:["💡"], cake:["🍰","🎂"], cane:["🦯"],
  card:["💳"], cart:["🛒"], city:["🏙"], coat:["🧥"],
  coin:["🪙"], comb:["🪮"], corn:["🌽"], crab:["🦀"],
  dart:["🎯"], date:["📅"], deer:["🦌"], dice:["🎲"],
  dino:["🦖"], disk:["💽"], door:["🚪"], dove:["🕊"],
  drop:["💧"], drum:["🪘","🥁"], duck:["🦆"], file:["🗄"],
  film:["🎥","🎬"], fire:["🔥"], fish:["🐟"], frog:["🐸"],
  gift:["🎁"], goal:["🥅"], goat:["🐐"], gold:["🥇"],
  herb:["🌿"], hole:["🕳"], hook:["🪝"], horn:["📯"],
  kite:["🪁"], knot:["🪢"], lamp:["🪔"], leaf:["🍃"],
  link:["🔗"], lion:["🦁"], lock:["🔒"], mail:["📨"],
  mall:["🏬"], mate:["🧉"], meat:["🍖"], memo:["📝"],
  milk:["🥛"], moon:["🌜","🎑"], nest:["🪹"], news:["🗞"],
  page:["📃"], palm:["🌴"], park:["🏞"], pear:["🍐"],
  pill:["💊"], pine:["🌲"], plug:["🔌"], rain:["🌧","☔️"],
  rice:["🍚"], ring:["💍"], rock:["🪨"], rose:["🌹"],
  salt:["🧂"], sari:["🥻"], seat:["💺"], ship:["🚢"],
  shoe:["👞"], sled:["🛷"], snow:["🌨"], soap:["🧼"],
  soda:["🥤"], sofa:["🛋"], star:["🌟"], surf:["🏄"],
  swan:["🦢"], swim:["🏊"], taco:["🌮"], tape:["📼"],
  taxi:["🚕"], wheel:["🛞"], tram:["🚊"], tree:["🌳"],
  urn:["⚱️"], vase:["🏺"], vest:["🦺"], wand:["🪄"],
  wave:["🌊"], wind:["🌬"], wine:["🍷"], wing:["🪽"],
  wolf:["🐺"], worm:["🪱"], yarn:["🧶"], yoga:["🧘"],
  yoyo:["🪀"], alarm:["⏰"], apple:["🍎"], bacon:["🥓"],
  bagel:["🥯"], banjo:["🪕"], beach:["🏖"], beans:["🫘"],
  bison:["🦬"], bread:["🍞"], brick:["🧱"], broom:["🧹"],
  brush:["🖌"], camel:["🐫"], candy:["🍬"], chair:["🪑"],
  chick:["🐤"], clock:["🕰"], coral:["🪸"], crown:["👑"],
  disco:["🪩"], dolls:["🎎"], donut:["🍩"], dress:["👗"],
  eagle:["🦅"], earth:["🌏"], ferry:["⛴"],
  fries:["🍟"], fuel:["⛽️"], gear:["⚙️"], goose:["🪿"],
  hippo:["🦛"], honey:["🍯"], horse:["🐎"], inbox:["📥"],
  juice:["🧃"], koala:["🐨"], lemon:["🍋"], llama:["🦙"],
  lotus:["🪷"], mango:["🥭"], maple:["🍁"], medal:["🎖"],
  melon:["🍈"], money:["💸"], moose:["🫎"], mouse:["🐁"],
  music:["🎼"], night:["🌃"], olive:["🫒"], onion:["🧅"],
  otter:["🦦"], panda:["🐼"], pants:["👖"], paper:["📄"],
  party:["🎉"], pasta:["🍝"], peach:["🍑"], phone:["📞"],
  piano:["🎹"], pizza:["🍕"], plant:["🪴"], plate:["🍽"],
  pouch:["👝"], purse:["👛"], radio:["📻"], razor:["🪒"],
  rhino:["🦏"], roach:["🪳"], rugby:["🏉"], ruler:["📏"],
  salad:["🥗"], scarf:["🧣"], shark:["🦈"], sheaf:["🌾"],
  sheep:["🐑"], shell:["🐚"], shirt:["👔"], siren:["🚨"],
  skunk:["🦨"], sleep:["🛌"], slide:["🛝"], sloth:["🦥"],
  snail:["🐌"], snake:["🐍"], socks:["🧦"], spoon:["🥄"],
  squid:["🦑"], steak:["🥩"], store:["🏪"], storm:["⛈"],
  sunny:["🌤"], sushi:["🍣"], teddy:["🧸"], tent:["⛺️"],
  tiger:["🐅"], toast:["🥂"], tools:["🛠"], tower:["🗼"],
  train:["🚆"], trash:["🗑"], truck:["🚚"], tulip:["🌷"],
  whale:["🐋"], yacht:["🛥"], zebra:["🦓"]
};

/* -----------------------------------------------------------
   2.  Helper shortcuts
----------------------------------------------------------------*/
const $ = id => document.getElementById(id);
const rngLabel = (rng,lbl)=>rng.addEventListener('input',()=>$(lbl).textContent=rng.value);
rngLabel($('emojiSize'),'emojiVal');
rngLabel($('labelSize'),'labelVal');
rngLabel($('padding'),'padVal');
rngLabel($('strokeW'),'strokeVal');

function ensureFont(family){
  const id='gfont-'+family.replace(/\s+/g,'-');
  if(!document.getElementById(id)){
    const link=document.createElement('link');
    link.id=id; link.rel='stylesheet';
    link.href=`https://fonts.googleapis.com/css2?family=${family.replace(/ /g,'+')}&display=swap`;
    document.head.appendChild(link);
  }
}

/* Random pick */
const choice = a => a[Math.random()*a.length|0];

/* -----------------------------------------------------------
   3.  Canvas generator
----------------------------------------------------------------*/
async function makeMatrix(){
  const cols = +$('cols').value;
  const rows = +$('rows').value;
  const maxL = +$('maxLen').value||0;

  const emojiPx = +$('emojiSize').value;
  const labelPx = +$('labelSize').value;
  const pad     = +$('padding').value;
  const strokeW = +$('strokeW').value;
  const strokeC = $('strokeCol').value;
  const font    = $('fontSel').value;

  ensureFont(font);
  /* wait until the font is actually available before drawing text */
  await document.fonts.load(`${labelPx}px "${font}"`);

  const words = Object.keys(wordMap).filter(w=>!maxL || w.length<=maxL);

  /* Cell dimensions: emoji + label + paddings top/bottom */
  const cellW = emojiPx + pad*2;
  const cellH = emojiPx + labelPx + pad*3;

  /* Large internal canvas size */
  const canvas = $('matrix');
  const scale  = window.devicePixelRatio||1;
  canvas.width  = cols*cellW*scale;
  canvas.height = rows*cellH*scale;
  canvas.style.width  = cols*cellW + 'px';
  canvas.style.height = rows*cellH + 'px';

  const ctx = canvas.getContext('2d');
  ctx.scale(scale,scale);
  ctx.clearRect(0,0,canvas.width/scale,canvas.height/scale);

  ctx.textAlign='center';
  ctx.textBaseline='middle';

  /* Draw grid + content */
  for(let r=0;r<rows;r++){
    for(let c=0;c<cols;c++){
      const x=c*cellW, y=r*cellH;
      const cx=x+cellW/2, cy=y+pad+emojiPx/2;

      const word=choice(words);
      const emo =choice(wordMap[word]);

      /* border */
      if(strokeW>0){
        ctx.lineWidth=strokeW;
        ctx.strokeStyle=strokeC;
        ctx.strokeRect(x,y,cellW,cellH);
      }

      /* emoji */
      ctx.font=`${emojiPx}px sans-serif`;
      ctx.fillText(emo,cx,cy);

      /* label */
      ctx.font=`${labelPx}px "${font}", sans-serif`;
      ctx.fillText(word,cx,y+emojiPx+pad*2+labelPx/2);
    }
  }

  /* Download button */
  $('download').onclick = ()=>{
    const link=document.createElement('a');
    link.download='word-matrix.png';
    link.href=canvas.toDataURL('image/png');
    link.click();
  };
}

/* -----------------------------------------------------------
   4.  UI wiring
----------------------------------------------------------------*/
$('generate').onclick=makeMatrix;
document.querySelectorAll('#controls input, #controls select')
        .forEach(el=>el.addEventListener('change',makeMatrix));

makeMatrix(); /* initial draw */
</script>
</body>
</html>
